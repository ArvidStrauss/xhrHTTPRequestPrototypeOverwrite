<script>
    /** ######################## **/
    /* LHM Custom Code TEST
    /* T-Systems MMS
    /* Version: 1.0.1
    /* Updated: 2020-05-15
    /** ######################## **/

    // Adjust matomo tracking settings here
    // If you adjust the following params, you have to adjust the src of the image tag above aswell
    const MATOMO_TARGET_ID = '2';
    const MATOMO_TARGET_PHP = 'https://webstatstest.muenchen.de/matomo.php';
    const MATOMO_TARGET_JS = 'https://webstatstest.muenchen.de/matomo.js';

    const CUSTOMDIMENSION_PAGETYPE = 1
    const CUSTOMDIMENSION_PAGETITLE = 2
    const CUSTOMDIMENSION_APPTYPE = 3
    const CUSTOMDIMENSION_APPTITLE = 4
    const CUSTOMDIMENSION_CONTENTTITLE = 5
    const CUSTOMDIMENSION_PAGETYPE_EVENT = 6
    const CUSTOMDIMENSION_PAGETITLE_EVENT = 7
    const CUSTOMDIMENSION_APPTYPE_EVENT = 8
    const CUSTOMDIMENSION_APPTITLE_EVENT = 9

    const CUSTOMDIMENSION_PAGETYPE_VISIT = 10
    const CUSTOMDIMENSION_PAGETITLE_VISIT = 11
    const CUSTOMDIMENSION_APPTYPE_VISIT = 12
    const CUSTOMDIMENSION_APPTITLE_VISIT = 13
    const CUSTOMDIMENSION_CONTENTTITLE_VISIT = 14
    const CUSTOMDIMENSION_PAGETYPE_EVENT_VISIT = 15
    const CUSTOMDIMENSION_PAGETITLE_EVENT_VISIT = 16
    const CUSTOMDIMENSION_APPTYPE_EVENT_VISIT = 17
    const CUSTOMDIMENSION_APPTITLE_EVENT_VISIT = 18
    
    // list timeline item tracked users here with profile uri endpoint
    // posts by these users in a timeline wont be tracked (likes,comments,...)
    const EXCLUDE_TIMELINETRACKINGUSERS = []; //'ian-bold', 'robert-lang'
    const EXCLUDED_PATHS = ['/admin/']; // '/workspaces/', '/admin/'
    const EXCLUDED_GROUPINGPATHS = ['/profile/','/account']; // '/workspaces/', '/admin/'
    const ENV = 'test';
    const CONTENTBASE = 'wilma';
    const USE_TAGMANAGER = true;

    const SELECTORS = {
        HEAD_NAVIGATION: '.navbar-main .nav-left a',
        HEAD_SUBNAVIGATION: '.navbar-sub a',
        NAV_SIDEBAR: '.sidebar .nav-sidebar-item a',
        SIDEBAR_SUBSCRIPTIONS: 'coyo-subscription-widget a',
        SIDEBAR_BOOKMARKS: 'coyo-bookmarking-show a',
        SEARCHFILTER_TYPE: 'coyo-filter[title-key="MODULE.SEARCH.TYPE"] a',
        SEARCHFILTER_MODIFIED: 'coyo-filter[title-key="MODULE.SEARCH.MODIFIED"] a',
        SEARCHFILTER_LOCATION: 'coyo-filter[title-key="MODULE.SEARCH.LOCATION"] a',
        SEARCHFILTER_AUTHOR: 'coyo-filter[title-key="MODULE.SEARCH.AUTHOR"] a',
    }
    var extanaSettingsOverride = {
        debug: true
    };

/* ###### Tracking Helper DB ###### */
var coyoTrackingDBHelper={objects:{},acceptedUrlPatterns:[],isAcceptedURL:function(t,s){return!(!t||!s)&&(0==this.acceptedUrlPatterns.length||this.acceptedUrlPatterns.some(function(e){return e[s.toLowerCase()]&&t.match(e[s.toLowerCase()])}))},buildAuthorMessage:function(e,t){return e=30<(e=e||"").length?e.substring(0,30).trim()+" ...":e,t?t.slug+" >> "+e:e},stripHTML:function(e){return e&&(new DOMParser).parseFromString(e,"text/html").body.textContent||""},buildTrackingTitle:function(e,t){if(!e)return"";var s,a=e.displayName||"";return"timeline-item"==e.typeName?(s=(e.data?e.data.message:this.stripHTML(e.excerpt))||"",a=this.buildAuthorMessage(s,e.author)):"comment"==e.typeName?(s=e.message||(e.data?e.data.message:""),a=this.buildAuthorMessage(s,e.author)):"user"==e.typeName&&(a=e.slug),a},checkStorageForData:function(e,t){if(!t)return null;try{for(var s=$.extend(JSON.parse(sessionStorage["ngStorage-etagBulkCache"]||null),JSON.parse(sessionStorage["coyo-etagBulkCache"]||null)),a=Object.keys(s),r=/"([0-9a-fA-F-]*)":/g.exec(t)[1],n=/:"([0-9a-fA-F-]*)"/g.exec(t)[1],i=0;i<a.length;i++){var p=s[a[i]][r];if(this.isAcceptedURL(a[i],e)&&p&&p.etag==n)return p.data||p.body}}catch(e){}return null},processParent:function(e){if("timeline-item"==e.typeName&&e.data){if("post"==e.itemType&&e.recipients&&1==e.recipients.length){var t=e.recipients[0];return{id:t.id,type:t.typeName,name:this.buildTrackingTitle(t)}}for(var s in e.data){var a;e.data[s]&&e.data[s].sender&&(this.setObjectData(e.data[s].sender),a={id:e.data[s].id,parent:{id:e.data[s].sender.id,typeName:e.data[s].sender.typeName,name:this.buildTrackingTitle(e.data[s].sender)}},this.setObjectData(a))}}else if("wiki-article"==e.typeName||"blog-article"==e.typeName){if(r=this.objects[e.senderId])return{id:e.senderId,type:r.type,name:r.name}}else if("comment"==e.typeName&&e.target){var r;if(r=this.objects[e.target.id])return{id:e.target.id,type:r.type,name:r.name}}return null},setObjectData:function(e,t){var s,a,r;e&&e.id&&(s=e.recipients&&1==e.recipients.length?e.recipients[0]:null,a=this.processParent(e),r=e.id,this.objects[r]=this.objects[r]||{name:"",type:"",target:{id:"",type:""},author:"",parent:{id:"",type:"",name:""}},this.objects[r].type=e.typeName||this.objects[r].type,this.objects[r].target.id=s?s.id:this.objects[r].target.id,this.objects[r].target.type=(s?s.typeName:"")||this.objects[r].target.type,this.objects[r].author=(e.author?e.author.slug:"")||this.objects[r].author,this.objects[r].parent.id=(a?a.id:e.parent?e.parent.id:"")||this.objects[r].parent.id,this.objects[r].parent.type=(a?a.typeName:e.parent?e.parent.typeName:"")||this.objects[r].parent.type,this.objects[r].parent.name=(a?a.name:e.parent?e.parent.name:"")||this.objects[r].parent.name,this.objects[r].name=t||(this.buildTrackingTitle(e,this.objects[r].parent)||this.objects[r].name))},getObjectData:function(e){return this.objects[e]||{name:"",type:"",target:{id:"",type:""},author:"",parent:{id:"",type:"",name:""}}},populateContentData:function(e){var t=this;e&&Array.isArray(e)&&e.forEach(function(e){t.setObjectData(e)})},populateResponseData:function(e,t,s){if(void 0!==e&&e&&"object"==typeof e&&this.isAcceptedURL(t,s)){var a=this;if(e.topApps&&e.topApps.forEach(function(e){a.setObjectData(e,e.slug)}),e.id&&this.setObjectData(e),e.content)this.populateContentData(e.content);else for(var r in e)e[r]&&e[r].content&&this.populateContentData(e[r].content)}}},openPrototypeDB=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){var method=arguments[0],reqURL=arguments[1];this.addEventListener("load",function(){var resp={};resp.responseType=this.responseType,resp.responseURL=this.responseURL||reqURL;try{resp.responseText=this.responseText,resp.responseHeader=this.getResponseHeader("x-bulk-etag")}catch(e){}setTimeout(function(){var response;try{""!=resp.responseType&&"text"!=resp.responseType&&"document"!=resp.responseType&&"moz-chunked-text"!=resp.responseType||!resp.responseText||(response=eval("("+resp.responseText+")"))}catch(e){}$.isEmptyObject(response)&&coyoTrackingDBHelper.isAcceptedURL(resp.responseURL,method)&&(response=coyoTrackingDBHelper.checkStorageForData(method,resp.responseHeader)),coyoTrackingDBHelper.populateResponseData(response,resp.responseURL,method)})},2),openPrototypeDB.apply(this,arguments)};

/* ###### Tracking Utils ###### */
var coyoTrackingUtils={createHashCode:function(e){var t,n=0;if(!e||0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},getUserIdHash:function(){return""+coyoTrackingUtils.createHashCode(localStorage.getItem("ngStorage-userId"))},cleanupCustomDimensions:function(){_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETYPE]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETITLE]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTYPE]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTITLE]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_CONTENTTITLE]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETYPE_EVENT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETITLE_EVENT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTYPE_EVENT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTITLE_EVENT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETYPE_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETITLE_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTYPE_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTITLE_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_CONTENTTITLE_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETYPE_EVENT_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_PAGETITLE_EVENT_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTYPE_EVENT_VISIT]),_paq.push(["deleteCustomDimension",CUSTOMDIMENSION_APPTITLE_EVENT_VISIT])},excludeUrl:function(t,e){var n=e||EXCLUDED_PATHS;return n&&n.some(function(e){return t&&0<=t.indexOf(location.host+e)})},excludeUser:function(e){var t="";if(!e||!e.type)return!1;switch(e.type){case"timeline-item":t=e.author;break;case"user":t=e.name;break;default:return!1}return EXCLUDE_TIMELINETRACKINGUSERS&&EXCLUDE_TIMELINETRACKINGUSERS.some(function(e){return e==t})},excludeFromTracking:function(e){var t=document.querySelector('coyo-library-file-details .coyo-file-details dt[translate="FILE_DETAILS.FILE_ORIGIN"]');if(t)try{var n=t.nextElementSibling.getElementsByTagName("a")[0],i=n?n.href:null;if(coyoTrackingUtils.excludeUrl(i,e))return!0}catch(e){}return coyoTrackingUtils.excludeUrl(location.href,e)||coyoTrackingUtils.preventTracking},typeNameOverrides:function(e,t){t=!("boolean"!=typeof t||!t);return(e={pages:"Seiten",page:"Seite",home:"Startseite",workspaces:"Arbeitsräume",arbeitsraeume:"Arbeitsräume",workspace:"Arbeitsraum","blog-article":"Blog-Artikel","wiki-article":"Wiki-Artikel","chat-message":"Chat",create:"Erstellen","timeline-item":"Timeline-Item",comment:"Kommentieren",share:"Teilen",subscribe:"Abonnieren",unsubscribe:"Deabonnieren",search:"Suche",timeline:"Timeline",filelibrary:"Dokumente","file-library":"Dokumente",content:"Content",article:"Artikel",list:"Liste",invited:"Einladungen",imprint:"Impressum",colleagues:"Kollegen",activity:"Aktivitaeten",quicksearch:"Schnellsuche"}[e.toLowerCase().trim()]||e)&&e.length&&(e=e.charAt(0).toUpperCase()+e.slice(1)),t&&(e=encodeURIComponent(coyoTrackingUtils.shortenString(e,200))),e},typeNameOverridesPageId:function(e){return{pages:"seiten",page:"seite",home:"startseite",workspaces:"ar",arbeitsraeume:"ar",workspace:"ar",search:"suche",filelibrary:"dokumente"}[e]||e},translateText:function(e){return e&&e.toLowerCase().replace(/[\/\ \.]/g,"-").replace(/\u00dc/g,"Ue").replace(/\u00fc/g,"ue").replace(/\u00c4/g,"Ae").replace(/\u00e4/g,"ae").replace(/\u00e4/g,"ae").replace(/\u00d6/g,"Oe").replace(/\u00f6/g,"oe").replace(/\u00df/g,"ss").replace(/_/g,"-").replace(/(?:\r\n|\r|\n)/g,"-").replace(/&/g," und ").replace(/@/g," -at- ").replace(/[^a-zA-Z0-9 \-\\.\/]+/g,"").replace(/\s+/g,"-").replace(/[-]{2,}/g,"-").replace(/^-*/g,"").replace(/-*$/g,"")||""},shortenString:function(e,t){return t=t||30,e.length>t?e.substring(0,t).trim()+"...":e},toAbsoluteUrl:function(){var t;return function(e){return(t=t||document.createElement("a")).href=e,t.href}}(),parseQueryString:function(e){var t=(e||"?").substr(1),i={};return t.replace(/([^&=]+)=?([^&]*)(?:&+|$)/g,function(e,t,n){(i[t]=i[t]||[]).push(n)}),i},getPageConfig:function(l){var s=[CONTENTBASE],c="";l=l||{};function p(e,t){var n=$("body").attr("class"),i=/state-main-(page|workspace|event)-show-apps-([\w\-]*)/g.exec(n)||/state-main-(page|workspace|event)-show-([\w\-]*)/g.exec(n)||/state-main-(page|workspace|event)-([\w\-]*)/g.exec(n),a=(a=i?/-(create|edit)$/g.exec(i[2]):null)?a[1]:null,r=$(".thread-view .thread-title").clone().children().remove().end().text().trim(),o=$($(".article-view .panel-title-main:first")[0]||$(".article-view .panel-title:first")[0]||$(".article-view .article-title:first")[0]).text().trim();a&&!o&&(o=$('form input[id*="title"]').val().trim());var l=o||r;l&&(e[e.length]=t[e.length]?t[e.length]:l,c=l+":"+(e[2]||"")),a&&(e[e.length]=t[e.length]?t[e.length]:a)}var e,t,n=$("nav.navbar-main ul.nav li.nav-item.active a");n.length||(n=$("div.sub-navigation nav.navbar ul.nav li.nav-item.active a.nav-item")),n.length&&n.attr("href")?(e=/\/([^?\/]*)/g.exec(n.attr("href")))&&1<e.length&&(s[1]=l[1]?l[1]:e[1]):$("div.content section.profile").length?s[1]=l[1]?l[1]:"profile":(t=/state-main-([\w-]*)/g.exec($("body:eq(0)").attr("class")))&&1<t.length?s[1]=l[1]?l[1]:t[1]:/state-admin/g.exec($("body:eq(0)").attr("class"))&&(s[1]=l[1]?l[1]:"admin");var i={home:function(){var e=/\/[^\/]*\/([^?\/]*)/g.exec(n.attr("href"));1<e.length&&(s[2]=l[2]?l[2]:e[1])},pages:function(){var e,t,n,i,a,r,o;e=s,t=l,n=$("section.page div.panel.panel-default div.panel-foreground div.titles-container div.title-description-wrapper div.title").text().trim()||(location.href.split("/")[4]?decodeURIComponent(location.href.split("/")[4]):null),i=$("section.page .content-sidebar .panel-navigation ul.nav.nav-default li.filter-entry.active a").text().trim()||coyoTrackingDBHelper.getObjectData(window.location.href.split("/")[7]).name,a=$("body").attr("class"),r=/state-main-page-show-apps-([\w\-]*)/g.exec(a)||/state-main-page-show-([\w\-]*)/g.exec(a)||/state-main-page-([\w\-]*)/g.exec(a),o=window.location.href.split("/")[6]?decodeURIComponent(window.location.href.split("/")[6]):r?r[1]:"",e[1]="pages",n&&(e[2]=t[2]?t[2]:n),o&&"create"!==o.toLowerCase()&&(e[3]=t[3]?t[3]:o),i&&(e[4]=t[4]?t[4]:i),p(s,l)},workspaces:function(){var e,t,n,i,a,r,o;e=s,t=l,n=$("section.workspace div.panel.panel-default div.panel-foreground div.titles-container div.title").text().trim()||(location.href.split("/")[4]?decodeURIComponent(location.href.split("/")[4]):null),i=$("section.workspace .content-sidebar .panel-navigation ul.nav.nav-default li.filter-entry.active a").text().trim()||coyoTrackingDBHelper.getObjectData(window.location.href.split("/")[7]).name,a=$("body").attr("class"),r=/state-main-workspace-show-apps-([\w\-]*)/g.exec(a)||/state-main-workspace-show-([\w\-]*)/g.exec(a)||/state-main-workspace-([\w\-]*)/g.exec(a),o=window.location.href.split("/")[6]?decodeURIComponent(window.location.href.split("/")[6]):r?r[1]:"",e[1]="workspaces",n&&(e[2]=t[2]?t[2]:n),o&&"create"!==o.toLowerCase()&&(e[3]=t[3]?t[3]:o),i&&(e[4]=t[4]?t[4]:i),p(s,l)},events:function(){var e,t,n,i,a,r;e=s,t=l,n=$("section.event div.panel.panel-default div.titles-container div.title").text().trim()||(location.href.split("/")[4]?decodeURIComponent(location.href.split("/")[4]):null),i=$("body").attr("class"),a=/state-main-event-show-([\w\-]*)/g.exec(i)||/state-main-event-([\w\-]*)/g.exec(i),r=window.location.href.split("/")[6]?decodeURIComponent(window.location.href.split("/")[6]):a?a[1]:"",e[1]="events",n&&(e[2]=t[2]?t[2]:n),r&&"create"!==r.toLowerCase()&&(e[3]=t[3]?t[3]:r)},profile:function(){var e=$("section.profile div.panel.panel-default div.titles-container div.title").text(),t=$("section.profile div.panel.panel-default div.profile-nav ul.nav li.nav-item.active").attr("href");t&&3<t.split("/").length&&(s[3]=l[3]?l[3]:t.split("/")[3]),s[2]=l[2]?l[2]:e},"timeline-item":function(){var e=/\/timeline\/item\/([0-9a-fA-F-]*)/g.exec(window.location.href);e&&(s[2]=l[2]?l[2]:coyoTrackingDBHelper.getObjectData(e[1]).name)},fileLibrary:function(){var e,t,n;e=s,t=l,n=decodeURIComponent(location.href.split("/")[6]),e[1]="filelibrary",n&&(e[2]=t[2]?t[2]:n)}};return i[s[1]]&&i[s[1]](),s[1]&&-1!==s[1].indexOf("#")&&(s[1]=s[1].substr(0,s[1].indexOf("#"))),{contentGroup:s,trackingTitle:c}},pageIdToString:function(e){var t="";if(e)for(i=0;i<100&&e[i];i++)t+=0<i?".":"",4<i&&i===e.length-1?t+=coyoTrackingUtils.shortenString(coyoTrackingUtils.typeNameOverridesPageId(coyoTrackingUtils.translateText(e[i]))):t+=coyoTrackingUtils.typeNameOverridesPageId(coyoTrackingUtils.translateText(e[i]));return t},getResponseHeaders:function(e){var t=e.getAllResponseHeaders().split(/\r\n/),n={};for(i=0;i<t.length;i++){var a=t[i].split(": "),r=a[0],o=a[1];n[r]=o}return n},getVideoInfo:function(e,t){var n,i=/documents\/([0-9a-fA-F-]*)/g.exec(e),a=coyoTrackingDBHelper.getObjectData(i[1]);a&&a.name&&a.name.length?t(a.name):((n=new XMLHttpRequest).open("HEAD",e),n.onreadystatechange=function(){var e;this.readyState==this.DONE&&(e=coyoTrackingUtils.getResponseHeaders(this)["content-disposition"].match(/filename=\".*(?=")/g)[0].replace('filename="',""),t(e))},n.send())}};

/* ###### Tracking Code ###### */
var currentUrl=location.href,initialStateChangeFired=!1,pendingSearch=0,lastFileId="",pageId,pageName,pageType,preventTracking,extanaSettings=Object.assign({system:"coyo",trackStateChanges:!0,trackCoyoStateClass:!0,trackCoyoStateClassVisit:!0,debug:!1,pkInitiate:!0,pkId:MATOMO_TARGET_ID,pkLibPathPHP:MATOMO_TARGET_PHP,pkLibPathJS:MATOMO_TARGET_JS,pkDomains:[location.hostname],pkLogUserUID:!1,pkHashUserUID:!0,pkActivateHeartbeat:!0,pkHeartbeatDelay:15,pkTrackMiddleRightMouseClick:!0,pkContentTracking:!0,pkContentTrackingDOMNode:".content",pkContentTrackingScanForMedia:!0,pkContentTrackingScanForForms:!0,pkContentTrackingAutoRefresh:!0,pkContentTrackingRefreshDelay:750,delayForStateChange:10,logAllApiCalls:!1,logAllApiCallsEvent:["API","Call"]},extanaSettingsOverride||{}),_paq=_paq||[];null!==extanaSettings.pkDomains&&_paq.push(["setDomains",extanaSettings.pkDomains]),function(){_paq.push(["setTrackerUrl",extanaSettings.pkLibPathPHP]),_paq.push(["setSiteId",extanaSettings.pkId]);var e=coyoTrackingUtils.getUserIdHash();"0"!==e&&_paq.push(["setUserId",e]);var t=document,n=t.createElement("script"),a=t.getElementsByTagName("script")[0];n.type="text/javascript",n.async=!0,n.defer=!0,n.src=extanaSettings.pkLibPathJS,a.parentNode.insertBefore(n,a)}(),_paq.push(["enableHeartBeatTimer",extanaSettings.pkHeartbeatDelay||15]),_paq.push(["setDownloadExtensions",""]),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var coyoRequestTrackingConfig=[{urlPattern:/web\/message-channels\/[0-9a-fA-F-]*\/messages$/g,method:"POST",execute:function(e,t){sendTrackingEvent("chat-message","Create","")}},{urlPattern:/web\/comments/g,method:"POST",execute:function(e,t){var n=coyoTrackingDBHelper.getObjectData(t.target.id);sendTrackingEvent(t.target.typeName,"Comment",n.name,n)}},{urlPattern:/subscriptions$/g,method:"POST",execute:function(e,t){var n=coyoTrackingDBHelper.getObjectData(t.targetId);sendTrackingEvent(n.type,"Subscribe",n.name,n)}},{urlPattern:/subscriptions\/favorite/g,method:"POST",execute:function(e,t){var n,a=coyoTrackingUtils.parseQueryString(e.replace(/.*\?/i,"?"));a.targetId&&sendTrackingEvent((n=coyoTrackingDBHelper.getObjectData(a.targetId)).type,"Subscribe",n.name,n)}},{urlPattern:/subscriptions.*\?targetId=/g,method:"DELETE",execute:function(e,t){var n,a=/targetId=([^\&]*)/g.exec(e);a&&1<a.length&&sendTrackingEvent((n=coyoTrackingDBHelper.getObjectData(a[1])).type||"unknown-type","Unsubscribe",n.name,n)}},{urlPattern:/web\/like-targets\//g,method:"POST",execute:function(e,t){var n,a=/like-targets\/([\w-]*)\/([0-9a-fA-F-]*)/g.exec(e);a&&1<a.length&&sendTrackingEvent(a[1],"Like",(n=coyoTrackingDBHelper.getObjectData(a[2])).name||coyoTrackingUtils.getPageConfig().trackingTitle||"",n)}},{urlPattern:/web\/like-targets\//g,method:"DELETE",execute:function(e,t){var n,a=/like-targets\/([\w-]*)\/([0-9a-fA-F-]*)/g.exec(e);a&&1<a.length&&sendTrackingEvent(a[1],"Unlike",(n=coyoTrackingDBHelper.getObjectData(a[2])).name||coyoTrackingUtils.getPageConfig().trackingTitle||"",n)}},{urlPattern:/web\/timeline-items/g,method:"POST",execute:function(e,t){t.recipients&&0<t.recipients.length&&sendTrackingEvent("timeline-item","Create",coyoTrackingUtils.typeNameOverrides(t.recipients[0].typeName)+" >> "+coyoTrackingDBHelper.buildTrackingTitle(t.recipients[0]),{type:"timeline-item",author:t.author.slug})}},{urlPattern:/web\/timeline-items/g,method:"DELETE",execute:function(e,t){var n,a=/\/web\/timeline-items\/([0-9a-fA-F-]*)$/g.exec(e);a&&1<a.length&&sendTrackingEvent("timeline-item","Delete",(n=coyoTrackingDBHelper.getObjectData(a[1])).name,n)}},{urlPattern:/web\/users\/([a-z0-9-]+)\/presence-status/g,method:"PUT",execute:function(e,t){sendTrackingEvent((t.state||"not defined").toLowerCase(),"Change Status","")}},{urlPattern:/web\/quick-entity-search/g,method:"GET",execute:function(e,t){setTimeout(function(){0==--pendingSearch&&sendSearchEvent(e,t,!0)},1e3)}},{urlPattern:/web\/search(?!.*filters=\w)/g,method:"GET",execute:function(e,t){sendSearchEvent(e,t,!1)}},{urlPattern:/web\/senders\/.*\/documents/g,method:"POST",execute:function(e,t){sendTrackingEvent("Media","Upload",t.displayName)}},{urlPattern:/web\/senders\/.*\/documents/g,method:"GET",execute:function(e,t){var n,a=/documents\/([0-9a-fA-F-]*)/g.exec(e),r=document.querySelector(".modal-dialog");a&&a[1]&&r&&(n=coyoTrackingDBHelper.getObjectData(a[1]),lastFileId!==n.name&&sendTrackingEvent("Media","Ansicht",n.name),lastFileId=n.name,setTimeout(function(){lastFileId=""},5e3))}},{urlPattern:/web\/senders\/.*\/files/g,method:"GET",execute:function(e,t,n,a){document.querySelector(".modal-dialog")&&t&&t.displayName&&t.displayName.length&&(lastFileId!==t.displayName&&sendTrackingEvent("Media","Ansicht",t.displayName),lastFileId=t.displayName,setTimeout(function(){lastFileId=""},5e3))}},{urlPattern:/web\/senders\/.*\/stream/g,method:"HEAD",execute:function(e,t,n,a){document.querySelector(".modal-dialog")&&coyoTrackingUtils.getVideoInfo(e,function(e){sendTrackingEvent("Media","Ansicht",e,null)})}},{urlPattern:/web\/shares\/(!multiple)/g,method:"POST",saveRequestData:!0,execute:function(e,t,n){var a=n?n.itemId:"",r=coyoTrackingDBHelper.getObjectData(a);sendTrackingEvent(r.type,"Share",r.name,r)}},{urlPattern:/web\/shares\/multiple\//g,method:"POST",saveRequestData:!0,execute:function(e,t,n){if(n)for(var a=0;a<n.length;a++){var r=n[a].itemId,i=coyoTrackingDBHelper.getObjectData(r),o=t[a];o&&o.recipient&&sendTrackingEvent(i.type,"Share",i.name,i)}}}];function sendTrackingEvent(e,t,n,a,r){var i,o,s,c,l;coyoTrackingUtils.excludeUser(a)||(o=(i=coyoTrackingUtils.getPageConfig()).contentGroup[1]||null,i.contentGroup[2],s=i.contentGroup[2]||null,c=i.contentGroup[3]||null,l=i.contentGroup[4]||null,"chat-message"===e&&"Create"===t&&(t="Nachricht senden"),"timeline-item"===e&&"Create"===t&&(n=""),e=coyoTrackingUtils.typeNameOverrides(e),t=coyoTrackingUtils.typeNameOverrides(t),coyoTrackingUtils.cleanupCustomDimensions(),o&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_PAGETYPE_EVENT,coyoTrackingUtils.typeNameOverrides(o)]),s&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_PAGETITLE_EVENT,coyoTrackingUtils.typeNameOverrides(s)]),c&&"show"!==c&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_APPTYPE_EVENT,coyoTrackingUtils.typeNameOverrides(c)]),l&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_APPTITLE_EVENT,coyoTrackingUtils.typeNameOverrides(l)]),"boolean"==typeof r&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_PAGETITLE_EVENT,r?"Suchergebnis":"Kein Suchergebnis"]),_paq.push(["trackEvent",e,t,n]),coyoTrackingUtils.cleanupCustomDimensions())}function sendSearchEvent(e,t,n){var a,r,i=coyoTrackingUtils.getPageConfig(),o=coyoTrackingUtils.parseQueryString(e.replace(/.*\?/i,"?"));return t&&o&&"object"==typeof o&&"term"in o&&"object"==typeof o.term&&(i=coyoTrackingUtils.getPageConfig(),a=1===o.term.length?decodeURIComponent(o.term[0].toString()):"",r="number"==typeof t.totalElements&&parseInt(t.totalElements),i.contentGroup[1]&&(_paq.push(["trackSiteSearch",a,n?coyoTrackingUtils.typeNameOverrides("quicksearch"):coyoTrackingUtils.typeNameOverrides("search"),r]),coyoTrackingUtils.cleanupCustomDimensions(),"boolean"==typeof n&&n||debounce(function(){setTimeout(function(){trackPageView(r)},extanaSettings.delayForStateChange||2)},250)())),!1}function initDownloadListener(){window.mtmDownloadListener=window.mtmDownloadListener||setInterval(function(){[].slice.call(document.querySelectorAll('a[coyo-download]:not(.piwik_ignore), a[href^="/web/senders/"][href*="/documents/"]:not(.piwik_ignore)')).forEach(function(t){t.classList.add("piwik_ignore"),coyoTrackingUtils.excludeFromTracking()||t.addEventListener("mousedown",function(){var e=function(e){var t=e.closest(".modal-file-details, .fl-table-row.file");if(t){var n,a=(n=t.querySelector("coyo-copy-file-link .copy-link a").dataset.clipboardText).split("/"),r=(o=decodeURIComponent(a[a.length-1])).lastIndexOf(" ");return{url:n,filename:o.substr(0,r)+"."+o.substr(r+1)}}if(/web\/senders\/([a-z0-9-]+)\/documents\/([a-z0-9-]+)/gi.exec(e.href))return n=(n=e.href.replace("/web/senders/","/files/").replace("/documents/","/")).lastIndexOf("/")===n.length-1?n:n+"/",{url:n+=encodeURIComponent(e.innerText.trim()),filename:e.innerText.trim()};if(e.getAttribute("coyo-download")){var i=e.firstElementChild,o="";return"file-name"===i.className?o=i.innerText.trim():null!==(t=e.closest(".single-file-widget-details-text"))&&(o=t.firstElementChild.innerText.trim()),{url:"",filename:o}}return null}(t);e.filename&&e.filename.length&&sendTrackingEvent("Media","Download",e.filename)})})},500)}function debounce(a,r,i){var o;return function(){initialStateChangeFired=!0;var e=this,t=arguments,n=i&&!o;clearTimeout(o),o=setTimeout(function(){o=null,i||a.apply(e,t)},r),n&&a.apply(e,t)}}function trackPageView(e){if("object"==typeof coyoTrackingUtils){var t,n=coyoTrackingUtils.getPageConfig(),a=coyoTrackingUtils.pageIdToString(n.contentGroup),r=n.contentGroup[1]||null,i=n.contentGroup[2]||null,o=n.contentGroup[3]||null,s=n.contentGroup[4]||null,c=n.contentGroup[5]||null;if(!coyoTrackingUtils.excludeFromTracking()&&a&&0!=a.indexOf(window.location.host+"..")){if(initDownloadListener(),coyoTrackingUtils.excludeFromTracking(EXCLUDED_GROUPINGPATHS)||(r&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_PAGETYPE,coyoTrackingUtils.typeNameOverrides(r)]),i&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_PAGETITLE,coyoTrackingUtils.typeNameOverrides(i)]),o&&"show"!==o&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_APPTYPE,coyoTrackingUtils.typeNameOverrides(o)]),s&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_APPTITLE,coyoTrackingUtils.typeNameOverrides(s)]),c&&_paq.push(["setCustomDimension",CUSTOMDIMENSION_CONTENTTITLE,coyoTrackingUtils.typeNameOverrides(c)])),_paq.push(["setReferrerUrl",currentUrl]),currentUrl=window.location.href,_paq.push(["setCustomUrl",currentUrl]),_paq.push(["setDocumentTitle",a]),_paq.push(["setGenerationTimeMs",0]),"search"===r){if(void 0===e)return;0<e?(_paq.push(["setDocumentTitle",a+".suchergebnis"]),_paq.push(["setCustomDimension",CUSTOMDIMENSION_PAGETITLE,"Suchergebnis"])):(_paq.push(["setDocumentTitle",a+".kein-suchergebnis"]),_paq.push(["setCustomDimension",CUSTOMDIMENSION_PAGETITLE,"Kein Suchergebnis"]))}extanaSettings.pkContentTracking&&(t=jQuery(extanaSettings.pkContentTrackingSelector).get(0),extanaSettings.pkContentTrackingScanForMedia&&_paq.push(["MediaAnalytics::scanForMedia",t]),extanaSettings.pkContentTrackingScanForForms&&_paq.push(["FormAnalytics::scanForForms",t]),"node"===extanaSettings.pkContentTrackingMode?_paq.push(["trackContentImpressionsWithinNode",t]):"delay"===extanaSettings.pkContentTrackingMode&&_paq.push(["trackVisibleContentImpressions",!0,extanaSettings.pkContentTrackingRefreshDelay||750])),extanaSettings.pkTrackMiddleRightMouseClick?_paq.push(["enableLinkTracking",!0]):_paq.push(["enableLinkTracking"]),_paq.push(["trackPageView"]),coyoTrackingUtils.cleanupCustomDimensions()}}else console.log("Coyo tracking utils not defined.")}window.document.addEventListener("stateChangeSuccess",debounce(function(){setTimeout(function(){trackPageView()},extanaSettings.delayForStateChange||2)},1e3),!1);var openPrototypeTracking=XMLHttpRequest.prototype.open,sendPrototypeTracking=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(){var method=arguments[0],reqURL=arguments[1],that=this;coyoRequestTrackingConfig.forEach(function(e){method==e.method&&reqURL&&reqURL.match(e.urlPattern)&&e.saveRequestData&&(that.saveRequestData=!0)}),reqURL.match(/web\/quick-entity-search/g)&&pendingSearch++,this.addEventListener("load",function(e){if(!coyoTrackingUtils.excludeFromTracking()){var resp={},rspPayload=null,reqQueryParams=null;resp.responseType=this.responseType,resp.responseURL=this.responseURL||reqURL,resp.requestData=this.requestData,resp.headers={},resp.headers=coyoTrackingUtils.getResponseHeaders(that);try{resp.responseText=this.responseText,rspPayload=0<e.currentTarget.responseText.length?JSON.parse(e.currentTarget.responseText):null,reqQueryParams=coyoTrackingUtils.parseQueryString(reqURL.replace(/.*\?/i,"?"))}catch(e){}setTimeout(function(){if("undefined"!=typeof coyoTrackingDBHelper){var response;try{""!=resp.responseType&&"text"!=resp.responseType&&"document"!=resp.responseType&&"moz-chunked-text"!=resp.responseType||!resp.responseText||(response=eval("("+resp.responseText+")"))}catch(e){}coyoRequestTrackingConfig.forEach(function(e){method==e.method&&resp.responseURL.match(e.urlPattern)&&"function"==typeof e.execute&&e.execute(resp.responseURL,response,resp.requestData,resp.headers)})}else console.log("Coyo tracking name data base not defined.")})}},2),openPrototypeTracking.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){try{arguments&&arguments[0]&&this.saveRequestData&&(this.requestData=JSON.parse(arguments[0]))}catch(e){}sendPrototypeTracking.apply(this,arguments)},USE_TAGMANAGER&&setTimeout(function(){initialStateChangeFired||(trackPageView(),initialStateChangeFired=!0)},extanaSettings.delayForStateChange||2);

/* ###### Custom Tracking Code ###### */
var ignore="data-piwikignore",ignoreSelector=":not(["+ignore+"]",coyoClickTracking={filterClickTracking:function(n,i){i.addEventListener("click",function(){var t="";i.querySelectorAll("span:not(.badge)").forEach(function(e){t+=e.textContent}),t=t.trim();var e=null!==i.querySelector("span.badge");sendTrackingEvent(n,"Klick",coyoTrackingUtils.typeNameOverrides(t),null,e)}),i.setAttribute("data-clickevent","true")},addVideoTracking:function(){document.querySelectorAll("video"+ignoreSelector).forEach(function(n){n.setAttribute(ignore,"true"),n.getAttribute("data-title")||coyoTrackingUtils.getVideoInfo(n.src,function(e){n.setAttribute("data-title",e)}),n.addEventListener("play",function(e){n.getAttribute("data-viewed")||setTimeout(function(){var e=n.getAttribute("data-title"),t=document.querySelector(".modal-dialog");e&&!t&&sendTrackingEvent("Media","Ansicht",e,null),n.setAttribute("data-viewed","true")},500)}),n.setAttribute(ignore,"true")})},addClickBindings:function(){document.querySelectorAll(SELECTORS.HEAD_NAVIGATION+ignoreSelector).forEach(function(n){return"$ctrl.openMenu()"===n.getAttribute("ng-click")||(n.addEventListener("click",function(e){var t="nav-item-brand"===n.className?"Startseite":n.querySelector(".nav-item-label").textContent.trim();sendTrackingEvent("Header","Klick",coyoTrackingUtils.typeNameOverrides(t),null)}),void n.setAttribute(ignore,"true"))}),document.querySelectorAll(SELECTORS.HEAD_SUBNAVIGATION+ignoreSelector).forEach(function(n){n.addEventListener("click",function(e){var t=n.textContent.trim();sendTrackingEvent("Navi-Top","Klick",coyoTrackingUtils.typeNameOverrides(t),null)}),n.setAttribute(ignore,"true")}),document.querySelectorAll(SELECTORS.NAV_SIDEBAR+ignoreSelector).forEach(function(i){i.addEventListener("click",function(e){for(var t=0;t<EXCLUDED_PATHS.length;t++)if(window.location.href.match(EXCLUDED_PATHS[t]))return;var n=i.textContent.trim();sendTrackingEvent("Navi-Mobile","Klick",coyoTrackingUtils.typeNameOverrides(n),null)}),i.setAttribute(ignore,"true")}),document.querySelectorAll(SELECTORS.SIDEBAR_SUBSCRIPTIONS+ignoreSelector).forEach(function(n){n.addEventListener("click",function(){var e=/\/pages\//gi.exec(n.href)?"Widget-Meine-Seiten":"Widget-Meine-Arbeitsraeume",t=n.querySelector(".senderName").textContent.trim();sendTrackingEvent(e,"Klick",coyoTrackingUtils.typeNameOverrides(t),null)}),n.setAttribute(ignore,"true")}),document.querySelectorAll(SELECTORS.SIDEBAR_BOOKMARKS+ignoreSelector).forEach(function(t){t.addEventListener("click",function(){var e=t.textContent.trim();sendTrackingEvent("Widget-Lesezeichen","Klick",coyoTrackingUtils.typeNameOverrides(e),null)}),t.setAttribute(ignore,"true")}),document.querySelectorAll(SELECTORS.SEARCHFILTER_TYPE+ignoreSelector).forEach(function(e){coyoClickTracking.filterClickTracking("Suche-Typ",e),e.setAttribute(ignore,"true")}),document.querySelectorAll(SELECTORS.SEARCHFILTER_MODIFIED+ignoreSelector).forEach(function(e){coyoClickTracking.filterClickTracking("Suche-Geaendert",e),e.setAttribute(ignore,"true")}),document.querySelectorAll(SELECTORS.SEARCHFILTER_LOCATION+ignoreSelector).forEach(function(e){coyoClickTracking.filterClickTracking("Suche-Ort",e),e.setAttribute(ignore,"true")}),document.querySelectorAll(SELECTORS.SEARCHFILTER_AUTHOR+ignoreSelector).forEach(function(e){coyoClickTracking.filterClickTracking("Suche-Autor",e),e.setAttribute(ignore,"true")})}};window.document.addEventListener("stateChangeSuccess",debounce(function(){setTimeout(function(){coyoClickTracking.addClickBindings(),coyoClickTracking.addVideoTracking()},extanaSettings.delayForStateChange||2)},1e3),!1);

</script>